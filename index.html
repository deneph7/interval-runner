<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ì¸í„°ë²Œ ëŸ¬ë„ˆ</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://cdnjs.cloudflare.com/ajax/libs/lottie-web/5.12.2/lottie.min.js"></script>
  <style>
    body {
      font-family: sans-serif;
      margin: 0;
      padding: 0;
      background: linear-gradient(to right, #667eea, #764ba2);
      color: white;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: flex-start;
      padding: 20px;
    }
    h1 {
      margin-bottom: 20px;
    }
    #animation {
      width: 300px;
      height: 300px;
      background: rgba(255, 255, 255, 0.08);
      border-radius: 20px;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
    }
    #phase {
      font-size: 22px;
      margin-bottom: 10px;
    }
    #timer {
      font-size: 28px;
      font-weight: bold;
      margin-bottom: 20px;
    }
    .buttons {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      justify-content: center;
    }
    button {
      background: rgba(255,255,255,0.2);
      color: white;
      font-size: 16px;
      font-weight: bold;
      border: none;
      padding: 10px 20px;
      border-radius: 10px;
      cursor: pointer;
    }
    button:disabled {
      opacity: 0.4;
    }
  </style>
</head>
<body>
  <h1>ğŸƒâ€â™‚ï¸ ì¸í„°ë²Œ ëŸ¬ë„ˆ</h1>
  <div id="animation"></div>
  <div id="phase">ì¤€ë¹„</div>
  <div id="timer">00:00</div>
  <div class="buttons">
    <button onclick="startWorkout()" id="start">ì‹œì‘</button>
    <button onclick="pauseWorkout()" id="pause" disabled>ì¼ì‹œì •ì§€</button>
    <button onclick="stopWorkout()" id="stop" disabled>ì •ì§€</button>
  </div>

  <script>
    let animation;
    let timer = null;
    let remaining = 0;
    let isPaused = false;
    let phase = "ready";
    let currentCycle = 1;
    const totalCycles = 5;
    const warmup = 10;
    const walk = 2;
    const run = 2;

    const animationContainer = document.getElementById("animation");
    const phaseEl = document.getElementById("phase");
    const timerEl = document.getElementById("timer");

    function loadAnimation(path) {
      if (animation) animation.destroy();
      animation = lottie.loadAnimation({
        container: animationContainer,
        renderer: "svg",
        loop: true,
        autoplay: true,
        path: path,
      });
    }

    function displayTimer(sec) {
      const m = String(Math.floor(sec / 60)).padStart(2, '0');
      const s = String(sec % 60).padStart(2, '0');
      timerEl.textContent = `${m}:${s}`;
    }

    function speak(text) {
      if ('speechSynthesis' in window) {
        const u = new SpeechSynthesisUtterance(text);
        u.lang = 'ko-KR';
        speechSynthesis.speak(u);
      }
    }

    function changePhase(p, sec, anim) {
      phase = p;
      remaining = sec * 60;
      phaseEl.textContent = p.toUpperCase();
      loadAnimation(anim);
      speak(p + " ì‹œì‘");
    }

    function startWorkout() {
      document.getElementById("start").disabled = true;
      document.getElementById("pause").disabled = false;
      document.getElementById("stop").disabled = false;
      currentCycle = 1;
      changePhase("ì›Œë°ì—…", warmup, "walk.json");
      runTimer();
    }

    function runTimer() {
      timer = setInterval(() => {
        if (!isPaused && remaining > 0) {
          remaining--;
          displayTimer(remaining);
        } else if (!isPaused && remaining <= 0) {
          nextPhase();
        }
      }, 1000);
    }

    function nextPhase() {
      if (phase === "ì›Œë°ì—…") {
        changePhase("ê±·ê¸°", walk, "walk.json");
      } else if (phase === "ê±·ê¸°") {
        changePhase("ë›°ê¸°", run, "run.json");
      } else if (phase === "ë›°ê¸°") {
        currentCycle++;
        if (currentCycle > totalCycles) {
          finish();
        } else {
          changePhase("ê±·ê¸°", walk, "walk.json");
        }
      }
    }

    function pauseWorkout() {
      isPaused = !isPaused;
      document.getElementById("pause").textContent = isPaused ? "ì¬ê°œ" : "ì¼ì‹œì •ì§€";
    }

    function stopWorkout() {
      clearInterval(timer);
      animation?.destroy();
      phase = "ready";
      timerEl.textContent = '00:00';
      phaseEl.textContent = 'ì¤‘ì§€ë¨';
      document.getElementById("start").disabled = false;
      document.getElementById("pause").disabled = true;
      document.getElementById("stop").disabled = true;
    }

    function finish() {
      clearInterval(timer);
      animation?.destroy();
      phase = "ì™„ë£Œ";
      phaseEl.textContent = "ğŸ‰ ë!";
      timerEl.textContent = "00:00";
      speak("ìš´ë™ ì™„ë£Œ");
      document.getElementById("pause").disabled = true;
      document.getElementById("stop").disabled = true;
    }
  </script>
</body>
</html>
